(this["webpackJsonpmesto-react-auth"]=this["webpackJsonpmesto-react-auth"]||[]).push([[0],{24:function(e,t,a){},44:function(e,t,a){},45:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a(1),r=a.n(i),o=a(25),c=a.n(o),s=a(12),l=a(20),u=a.n(l),p=a(26),d=a(23),j=a(3),b=a(2),m=a(4),h=a(16),_=a(17),O=new(function(){function e(t){var a=t.url,n=t.login,i=t.user,r=t.cards,o=t.auth;Object(h.a)(this,e),this._url=a,this._user=i,this._cards=r,this.login=n,this.auth=o,this.token=""}return Object(_.a)(e,[{key:"_getResponse",value:function(e){return[200,400,401].includes(e.status)?e.json():Promise.reject(new Error("\u041e\u0448\u0438\u0431\u043a\u0430 api: ".concat(e.status)))}},{key:"register",value:function(e){var t=Object.fromEntries(Object.entries(e).filter((function(e){var t=Object(b.a)(e,2);t[0];return""!==t[1]})));return fetch("".concat(this._url).concat(this.auth),{method:"POST",headers:{"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify(Object(j.a)({},t))}).then(this._getResponse)}},{key:"authorizationPost",value:function(e){var t=e.password,a=e.email;return fetch("".concat(this._url).concat(this.login),{method:"POST",headers:{"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify({password:t,email:a})}).then(this._getResponse)}},{key:"getInfoForUser",value:function(){return fetch("".concat(this._url).concat(this._user),{method:"GET",headers:{"Content-type":"application/json; charset=UTF-8",Authorization:"Bearer ".concat(this.token)}}).then(this._getResponse)}},{key:"getInfoForCards",value:function(){return fetch("".concat(this._url).concat(this._cards),{method:"GET",headers:{Authorization:"Bearer ".concat(this.token),"Content-type":"application/json; charset=UTF-8"}}).then(this._getResponse)}},{key:"updateUserInfo",value:function(e){var t=e.name,a=e.about;return fetch("".concat(this._url).concat(this._user),{method:"PATCH",headers:{Authorization:"Bearer ".concat(this.token),"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify({name:t,about:a})}).then(this._getResponse)}},{key:"updateUserAvatar",value:function(e){var t=e.avatar;return fetch("".concat(this._url).concat(this._user,"/avatar"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(this.token),"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify({avatar:t})}).then(this._getResponse)}},{key:"addCard",value:function(e){var t=e.name,a=e.link;return fetch("".concat(this._url).concat(this._cards),{method:"POST",headers:{Authorization:"Bearer ".concat(this.token),"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify({name:t,link:a})}).then(this._getResponse)}},{key:"changeLikeCardStatus",value:function(e,t){var a=t?"PUT":"DELETE";return fetch("".concat(this._url).concat(this._cards,"/").concat(e,"/likes"),{method:a,headers:{Authorization:"Bearer ".concat(this.token),"Content-type":"application/json; charset=UTF-8"}}).then(this._getResponse)}},{key:"deleteCard",value:function(e){return fetch("".concat(this._url).concat(this._cards,"/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(this.token),"Content-type":"application/json; charset=UTF-8"}}).then(this._getResponse)}}]),e}())({url:"/",user:"users/me",cards:"cards",login:"signin",auth:"signup"}),v=r.a.createContext();var g=function(e){var t=e.card,a=e.onCardClick,i=e.onCardDelete,o=e.onCardLike,c=r.a.useContext(v)._id,s=r.a.useState(!0),l=Object(b.a)(s,2),u=l[0],p=l[1];return Object(n.jsx)(r.a.Fragment,{children:u&&Object(n.jsxs)("div",{className:"element",children:[Object(n.jsx)("img",{src:t.link,alt:t.name,className:"element__pic",onError:function(){p(!1)},onClick:function(){return a(t)}}),Object(n.jsx)("button",{className:"element__button-trash ".concat(t.owner===c?"element__button-trash_visible":""),type:"button",title:"\u043a\u043d\u043e\u043f\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438",onClick:function(){return i(t)}}),Object(n.jsxs)("div",{className:"element__info",children:[Object(n.jsx)("h2",{className:"element__title",title:t.name,children:t.name}),t.likes&&Object(n.jsxs)("div",{className:"element__like",children:[Object(n.jsx)("button",{className:"element__button-like element__button-like_color_white ".concat(t.likes.find((function(e){return e===c}))?"element__button-like_color_black":""),type:"button",title:"\u043a\u043d\u043e\u043f\u043a\u0430 \u0434\u043b\u044f \u043b\u0430\u0439\u043a\u043e\u0432",onClick:function(){return o(t)}}),Object(n.jsx)("span",{className:"element__counter-like",title:t.likes.map((function(){return"\ud83d\udda4"})),children:t.likes.length})]})]})]})})};var f=function(e){var t=e.onAddPlace,a=e.onEditAvatar,i=e.onEditProfile,o=r.a.useContext(v),c=o.name,s=o.about,l=o.avatar,u=o._id;return Object(n.jsxs)("section",{className:"profile page__profile",children:[Object(n.jsx)("img",{id:u,src:l,alt:"\u0410\u0432\u0430\u0442\u0430\u0440\u043a\u0430",onClick:a,className:"profile__avatar"}),Object(n.jsxs)("div",{className:"profile__info",children:[Object(n.jsx)("h1",{className:"profile__title",title:c,children:c}),Object(n.jsx)("button",{type:"button",title:"\u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u0440\u043e\u0444\u0438\u043b\u044f",className:"profile__edit-button",onClick:i}),Object(n.jsx)("p",{className:"profile__subtitle",title:s,children:s})]}),Object(n.jsx)("button",{type:"button",title:"\u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0438",className:"profile__add-button",onClick:t})]})};a(24);var x=function(e){var t=e.cards,a=e.onAddPlace,i=e.onEditAvatar,o=e.onEditProfile,c=e.handleCardLike,s=e.handleCardClick,l=e.handleCardDelete;return Object(n.jsxs)(r.a.Fragment,{children:[Object(n.jsx)(f,{onAddPlace:a,onEditAvatar:i,onEditProfile:o}),Object(n.jsx)("div",{className:"elements page__elements",children:t.map((function(e){return Object(n.jsx)(g,{card:e,onCardLike:c,onCardClick:s,onCardDelete:l},e.createdAt+e._id)}))})]})},k=a(7),C=a(6),N=a.n(C);function y(e){var t=e.info,a=e.link,i=e.signOut,o=e.selectorPlace,c=Object(m.g)(),l=r.a.useState(""),u=Object(b.a)(l,2),p=u[0],d=u[1],j=r.a.useContext(v).email,h=N()("navbar",{navbar_place_header:"header"===o,navbar_place_form:"form"===o,navbar_place_page:"page"===o});return r.a.useEffect((function(){"/sign-up"===c.location.pathname?d("\u0412\u0445\u043e\u0434"):"/sign-in"===c.location.pathname?d("\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"):"/"===c.location.pathname&&d("\u0412\u044b\u0439\u0442\u0438")}),[c.location.pathname]),Object(n.jsxs)("nav",{className:h,children:[j&&Object(n.jsx)("p",{className:"navbar__info",children:j}),"form"===o&&Object(n.jsx)("p",{className:"navbar__info",children:t}),Object(n.jsx)(s.b,{className:"navbar__link",to:a,onClick:function(e){return i(e)},children:p})]})}y.defaultProps={selectorPlace:"",info:"",link:""};var w=y;function S(e){var t=e.active,a=e.name,i=e.title,o=e.isOpen,c=e.onClose,s=e.children,l=e.onSubmit,u=e.buttonTitle,p=e.userAuthInfo,d=e.signOut,j=t?"disabled":"",b=N()("popup popup_type_".concat(a),{popup_opened:o}),m=N()("popup__title",{popup__title_type_check:"check"===a}),h=N()("popup__button-submit",{"popup__button-submit_type_check":"check"===a,"popup__button-submit_type_register":p,"popup__button-submit_disabled":t&&"check"!==a});return Object(n.jsx)(r.a.Fragment,{children:Object(n.jsx)("div",{className:b,onMouseDown:function(e){return e.currentTarget===e.target&&c()},children:Object(n.jsxs)("form",{className:"popup__container popup__container_type_".concat(a),name:a,onSubmit:l,children:[Object(n.jsx)("h2",{className:m,children:i}),s,Object(n.jsx)("button",{className:h,type:"submit",title:u,disabled:j,children:u}),p&&Object(n.jsx)(w,{info:p.info,link:p.link,signOut:d,selectorPlace:"form"}),c&&Object(n.jsx)("button",{className:"popup__button-close",type:"button",title:"\u0437\u0430\u043a\u0440\u044b\u0442\u044c",onClick:c})]})})})}S.defaultProps={active:!1,isOpen:!1,children:null,onClose:void 0};var L=S,E=function(e){var t=N()("popup__input",{popup__input_type_error:e.avatarUser});return Object(n.jsxs)(r.a.Fragment,{children:[Object(n.jsx)("input",{className:t,type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",id:"input-avatar",name:"avatar",value:e.avatarUser,onChange:e.editAvatar,onInput:e.validationAvatar,required:!0}),""!==e.avatar&&Object(n.jsx)("div",{className:"popup__error",children:Object(n.jsx)("span",{className:"popup__input-error popup__input-error_active",id:"input-avatar-error ",children:e.avatarMessage})})]})},T=function(e){var t=N()("popup__input",{popup__input_type_error:e.nameProfile||e.about});return Object(n.jsxs)(r.a.Fragment,{children:[Object(n.jsx)("input",{className:t,id:"input-name",type:"text",name:"name",minLength:"2",maxLength:"40",placeholder:"\u0418\u043c\u044f",value:e.nameProfile,onChange:e.editName,onInput:e.validationProfile,required:!0}),""===e.nameProfile&&Object(n.jsx)("div",{className:"popup__error",children:Object(n.jsx)("span",{className:"popup__input-error popup__input-error_active",id:"input-name-error",children:e.profileMessage.name})}),Object(n.jsx)("input",{className:t,id:"input-about",type:"text",name:"about",minLength:"2",maxLength:"200",placeholder:"\u041f\u0440\u043e\u0444\u0435\u0441\u0441\u0438\u044f",value:e.about,onChange:e.editAbout,onInput:e.validationProfile,required:!0}),""===e.about&&Object(n.jsx)("div",{className:"popup__error",children:Object(n.jsx)("span",{className:"popup__input-error popup__input-error_active",id:"input-about-error",children:e.profileMessage.about})})]})},P=function(e){var t=N()("popup__input",{popup__input_type_error:e.place||e.link});return Object(n.jsxs)(r.a.Fragment,{children:[Object(n.jsx)("input",{className:t,type:"text",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",id:"input-place",name:"place",minLength:"1",value:e.place,maxLength:"30",onChange:e.editPlace,onInput:e.validationPlace,required:!0}),""===e.place&&Object(n.jsx)("div",{className:"popup__error",children:Object(n.jsx)("span",{className:"popup__input-error popup__input-error_active",id:"input-place-error",children:e.placeMessage.place})}),Object(n.jsx)("input",{className:t,type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",id:"input-link",value:e.link,name:"link",onChange:e.editLink,onInput:e.validationPlace,required:!0}),""!==e.link&&Object(n.jsx)("div",{className:"popup__error",children:Object(n.jsx)("span",{className:"popup__input-error popup__input-error_active",id:"input-link-error",children:e.placeMessage.link})})]})},I=function(e){var t=N()("popup__input popup__input_type_check",{popup__input_type_error:e.password||e.email});return Object(n.jsxs)(r.a.Fragment,{children:[Object(n.jsx)("input",{className:t,type:"email",placeholder:"\u041f\u043e\u0447\u0442\u0430",id:"input-email",value:e.email,name:"email",onChange:e.editEmail,onInput:e.validationCheck,required:!0}),""!==e.email&&Object(n.jsx)("div",{className:"popup__error",children:Object(n.jsx)("span",{className:"popup__input-error popup__input-error_active",id:"input-email-error",children:e.placeMessage.email})}),Object(n.jsx)("input",{className:t,type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",id:"input-password",name:"password",minLength:"6",value:e.password,maxLength:"30",onChange:e.editPassword,onInput:e.validationCheck,autoComplete:"off",required:!0}),e.password&&Object(n.jsx)("div",{className:"popup__error",children:Object(n.jsx)("span",{className:"popup__input-error popup__input-error_active",id:"input-password-error",children:e.placeMessage.password})})]})},A=function(e){var t=N()("popup__input popup__input_type_check",{popup__input_type_error:e.password||e.email||e.name||e.about||e.avatarUser});return Object(n.jsxs)(r.a.Fragment,{children:[Object(n.jsx)("input",{className:t,id:"input-name",type:"text",name:"name",minLength:"2",maxLength:"40",placeholder:"\u0412\u0430\u0448\u0435 \u0438\u043c\u044f",value:e.name,onChange:e.editName,onInput:e.validationCheck}),""!==e.name&&Object(n.jsx)("div",{className:"popup__error",children:Object(n.jsx)("span",{className:"popup__input-error popup__input-error_active",id:"input-name-error",children:e.placeMessage.name})}),Object(n.jsx)("input",{className:t,id:"input-about",type:"text",name:"about",minLength:"2",maxLength:"200",placeholder:"\u0412\u0430\u0448\u0430 \u043f\u0440\u043e\u0444\u0435\u0441\u0441\u0438\u044f",value:e.about,onChange:e.editAbout,onInput:e.validationCheck}),""!==e.about&&Object(n.jsx)("div",{className:"popup__error",children:Object(n.jsx)("span",{className:"popup__input-error popup__input-error_active",id:"input-about-error",children:e.placeMessage.about})}),Object(n.jsx)("input",{className:t,type:"email",placeholder:"\u041f\u043e\u0447\u0442\u0430",id:"input-email",value:e.email,name:"email",onChange:e.editEmail,onInput:e.validationCheck,title:"\u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435",required:!0}),""!==e.email&&Object(n.jsx)("div",{className:"popup__error",children:Object(n.jsx)("span",{className:"popup__input-error popup__input-error_active",id:"input-email-error",children:e.placeMessage.email})}),Object(n.jsx)("input",{className:t,type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",id:"input-password",name:"password",minLength:"6",value:e.password,maxLength:"30",onChange:e.editPassword,onInput:e.validationCheck,autoComplete:"off",title:"\u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435",required:!0}),e.password&&Object(n.jsx)("div",{className:"popup__error",children:Object(n.jsx)("span",{className:"popup__input-error popup__input-error_active",id:"input-password-error",children:e.placeMessage.password})}),Object(n.jsx)("input",{className:t,type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440\u043a\u0443",id:"input-avatar",name:"avatar",value:e.avatarUser,onChange:e.editAvatar,onInput:e.validationCheck}),""!==e.avatar&&Object(n.jsx)("div",{className:"popup__error",children:Object(n.jsx)("span",{className:"popup__input-error popup__input-error_active",id:"input-avatar-error ",children:e.placeMessage.avatar})})]})},F=function(e){return Object(n.jsx)("div",{className:e.classTool,onMouseDown:function(t){return t.currentTarget===t.target&&e.onClose()},children:Object(n.jsxs)("div",{className:"popup__container popup__container_type_tool",children:[Object(n.jsx)("img",{className:"popup__pic popup__pic_type_tool",src:e.icon,alt:e.alt}),Object(n.jsx)("p",{className:"popup__title popup__title_type_tool",children:e.title}),Object(n.jsx)("button",{className:"popup__button-close",onClick:e.onClose})]})})};var U=function(e){var t=e.isOpen,a=e.onLogin,i=e.signOut,o=e.isLoadingButton,c=localStorage.getItem("email")?localStorage.getItem("email"):"",s=r.a.useState(!0),l=Object(b.a)(s,2),u=l[0],p=l[1],d=r.a.useState({email:c||"",password:""}),m=Object(b.a)(d,2),h=m[0],_=m[1],O=r.a.useState({password:"",email:""}),v=Object(b.a)(O,2),g=v[0],f=v[1],x={name:"check",title:"\u0412\u0445\u043e\u0434",buttonTitle:"".concat(o?"\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430...":"\u0412\u043e\u0439\u0442\u0438")};return Object(n.jsx)(r.a.Fragment,{children:Object(n.jsx)("div",{className:"page__elements",children:Object(n.jsx)(L,{name:x.name,title:x.title,buttonTitle:x.buttonTitle,isOpen:t,active:u,signOut:i,onSubmit:function(e){e.preventDefault(),h.password&&h.email&&a(e,h)},children:Object(n.jsx)(I,{email:h.email,password:h.password,placeMessage:g,editEmail:function(e){_(Object(j.a)(Object(j.a)({},h),{},{email:e.target.value})),p(!e.target.value)},editPassword:function(e){_(Object(j.a)(Object(j.a)({},h),{},{password:e.target.value})),p(!e.target.value)},validationCheck:function(e){e.target.validity.valid||f(Object(k.a)({},e.target.name,e.target.validationMessage)),f(Object(k.a)({},e.target.name,""))}})})})})},M=a.p+"static/media/logoFon.8724261e.svg";var D=function(e){var t=e.toggleNavbar,a=e.signOut,i=e.link,r=e.selectorPlace,o=e.isNavbarOpen;return Object(n.jsxs)("header",{className:"header page__header",children:[Object(n.jsx)("img",{className:"logo logo_place_header",src:M,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f"}),Object(n.jsxs)("label",{children:[Object(n.jsx)("input",{type:"checkbox",className:"header__button-menu",onChange:t}),Object(n.jsx)("span",{id:"span",className:"header__button-menu"})]}),!o&&Object(n.jsx)(w,{selectorPlace:r,link:i,signOut:a})]})};var B=function(){return Object(n.jsx)("footer",{className:"footer page__footer",children:Object(n.jsxs)("p",{className:"footer__copyright",children:["\xa9",(new Date).getFullYear()," Mesto Russia"]})})};a(44);var R=function(){return Object(n.jsx)("div",{className:"lds-dual-ring"})};function W(e){var t=e.isOpen,a=e.signOut,i=e.onRegister,o=e.isLoadingButton,c=r.a.useState({password:"",email:"",name:"",about:"",avatar:""}),s=Object(b.a)(c,2),l=s[0],u=s[1],p=r.a.useState(!0),d=Object(b.a)(p,2),m=d[0],h=d[1],_=r.a.useState({}),O=Object(b.a)(_,2),v=O[0],g=O[1],f={name:"check",title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",buttonTitle:"".concat(o?"\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430...":"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"),linkInfo:{link:"/sign-in",info:"\u0412\u044b \u0443\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c?"}};function x(e){u(Object(j.a)(Object(j.a)({},l),{},Object(k.a)({},e.target.name,e.target.value))),h(!e.target.value)}return Object(n.jsx)(r.a.Fragment,{children:Object(n.jsx)("div",{className:"page__elements",children:Object(n.jsx)(L,{isOpen:t,active:m,name:f.name,title:f.title,buttonTitle:f.buttonTitle,userAuthInfo:f.linkInfo,signOut:a,onSubmit:function(e){e.preventDefault(),u(Object(j.a)(Object(j.a)({},l),{},{password:"",email:"",name:"",about:"",avatar:""})),i(Object(j.a)({},l))},children:Object(n.jsx)(A,{about:l.about,email:l.email,name:l.name,avatarUser:l.avatar,password:l.password,placeMessage:v,editEmail:x,editPassword:x,editAvatar:x,editName:x,editAbout:x,validationCheck:function(e){e.target.validity.valid||g(Object(k.a)({},e.target.name,e.target.validationMessage)),g(Object(k.a)({},e.target.name,""))}})})})})}W.defaultProps={isOpen:!1};var z=W;var q=function(e){var t=e.error.message;return Object(n.jsx)(r.a.Fragment,{children:Object(n.jsxs)("div",{style:{color:"#f00",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"60vh"},children:[Object(n.jsx)("h1",{children:t}),Object(n.jsx)("p",{style:{color:"#fff"},children:"\u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0437\u0430\u0439\u0442\u0438 \u043f\u043e\u0437\u0436\u0435"})]})})};var J=function(e){var t=e.selectedCard,a=e.onClose,i=e.isOpen,o=e.toggleEventListenerWindow;r.a.useEffect((function(){return i&&o(!0),function(){o(!1)}}),[i]);var c=N()("popup popup_type_zoom",{popup_opened:i}),s=N()("popup__pic",{popup__pic_type_check:"check"===t.name});return Object(n.jsx)("div",{className:c,onMouseDown:function(e){return e.currentTarget===e.target&&a()},children:Object(n.jsxs)("div",{className:"popup__zoom",children:[Object(n.jsx)("img",{className:s,src:t.link,alt:t.name}),"check"!==t.name&&Object(n.jsx)("span",{className:"popup__place-pic",children:t.name}),Object(n.jsx)("button",{className:"popup__button-close",type:"button",title:"\u0437\u0430\u043a\u0440\u044b\u0442\u044c",onClick:a})]})})},H=a.p+"static/media/iconOk.a9eb6caf.svg",G=a.p+"static/media/iconUnion.d4ce2a26.svg";var Y=function(e){var t=e.isOpen,a=e.onClose,i=e.toggleEventListenerWindow,o=t.isOpenTool,c=t.status,s=t.message,l={title:""!==s?s:c?"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c.":"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437.",alt:c?"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043f\u0440\u043e\u0439\u0434\u0435\u043d\u0430":"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043d\u0435 \u043f\u0440\u043e\u0439\u0434\u0435\u043d\u0430",icon:c?H:G,classTool:N()("popup",{"popup_opened popup__type_tool":o})};return r.a.useEffect((function(){return o&&i(!0),function(){i(!1)}}),[o]),Object(n.jsx)(F,{alt:l.alt,icon:l.icon,title:l.title,classTool:l.classTool,onClose:a},l.id)};var K=function(e){var t=e.isLoadingButton,a=e.isOpen,i=e.onClose,o=e.onAddPlace,c=e.toggleEventListenerWindow;r.a.useEffect((function(){return a&&c(!0),function(){c(!1)}}),[a]);var s={name:"place",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",buttonTitle:"".concat(t?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")},l=r.a.useState(""),u=Object(b.a)(l,2),p=u[0],d=u[1],j=r.a.useState(""),m=Object(b.a)(j,2),h=m[0],_=m[1],O=r.a.useState(!0),v=Object(b.a)(O,2),g=v[0],f=v[1],x=r.a.useState({place:"",link:""}),C=Object(b.a)(x,2),N=C[0],y=C[1];return Object(n.jsx)(L,{isOpen:a,onClose:i,active:g,name:s.name,title:s.title,buttonTitle:s.buttonTitle,onSubmit:function(e){e.preventDefault(),d(""),_(""),o({name:p,link:h})},children:Object(n.jsx)(P,{link:h,place:p,placeMessage:N,editLink:function(e){_(e.target.value),f(!e.target.value)},editPlace:function(e){d(e.target.value),f(!e.target.value)},validationPlace:function(e){e.target.validity.valid||y(Object(k.a)({},e.target.name,e.target.validationMessage)),y(Object(k.a)({},e.target.name,""))}})})},Q=a(29),V=a(28),X=function(e){Object(Q.a)(a,e);var t=Object(V.a)(a);function a(e){var n;return Object(h.a)(this,a),(n=t.call(this,e)).state={error:null,errorInfo:null},n}return Object(_.a)(a,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e,errorInfo:t})}},{key:"render",value:function(){var e=this.state,t=e.errorInfo,a=e.error;return t?Object(n.jsxs)("div",{children:[Object(n.jsx)("h2",{children:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a!"}),Object(n.jsxs)("details",{style:{whiteSpace:"pre-wrap"},children:[a&&a.toString(),Object(n.jsx)("br",{}),t.componentStack]})]}):this.props.children}}]),a}(r.a.Component),Z=function(e){var t=e.children,a=e.loggedIn;return Object(n.jsx)(m.b,{children:function(){return a?Object(n.jsx)(r.a.Fragment,{children:t}):Object(n.jsx)(m.a,{to:"/sign-in"})}})};var $=function(e){var t=e.isLoadingButton,a=e.isOpen,i=e.onClose,o=e.onUpdateAvatar,c=e.toggleEventListenerWindow;r.a.useEffect((function(){return a&&c(!0),function(){c(!1)}}),[a]);var s={name:"avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",buttonTitle:"".concat(t?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")},l=r.a.useState(""),u=Object(b.a)(l,2),p=u[0],d=u[1],j=r.a.useState(!0),m=Object(b.a)(j,2),h=m[0],_=m[1],O=r.a.useState(""),v=Object(b.a)(O,2),g=v[0],f=v[1];return Object(n.jsx)(L,{name:s.name,title:s.title,buttonTitle:s.buttonTitle,isOpen:a,onClose:i,active:h,onSubmit:function(e){e.preventDefault(),d(""),o({avatar:p})},children:Object(n.jsx)(E,{avatarUser:p,editAvatar:function(e){d(e.target.value),_(!e.target.value)},avatarMessage:g,validationAvatar:function(e){e.target.validity.valid||f(e.target.validationMessage),f("")}})})};var ee=function(e){var t=e.isOpen,a=e.isCard,i=e.onClose,o=e.onDeleteCard,c=e.isLoadingButton,s=e.toggleEventListenerWindow;r.a.useEffect((function(){return t&&s(!0),function(){s(!1)}}),[t]);var l={name:"delete",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",buttonTitle:"".concat(c?"\u0423\u0434\u0430\u043b\u044f\u0435\u043c...":"\u0414\u0430")};return Object(n.jsx)(L,{isOpen:t,onClose:i,name:l.name,title:l.title,buttonTitle:l.buttonTitle,onSubmit:function(e){e.preventDefault(),o(a)}})};var te=function(e){var t=e.isLoadingButton,a=e.isOpen,i=e.onClose,o=e.onUpdateUser,c=e.toggleEventListenerWindow;r.a.useEffect((function(){return a&&c(!0),function(){c(!1)}}),[a]);var s={name:"profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0444\u043e\u0440\u043c\u0443",buttonTitle:"".concat(t?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")},l=r.a.useContext(v),u=r.a.useState({name:""}),p=Object(b.a)(u,2),d=p[0],j=p[1],m=r.a.useState({about:""}),h=Object(b.a)(m,2),_=h[0],O=h[1],g=r.a.useState(!0),f=Object(b.a)(g,2),x=f[0],C=f[1],N=r.a.useState({name:"",about:""}),y=Object(b.a)(N,2),w=y[0],S=y[1];return r.a.useEffect((function(){j(l.name),O(l.about)}),[l]),Object(n.jsx)(L,{isOpen:a,onClose:i,active:x,name:s.name,title:s.title,buttonTitle:s.buttonTitle,onSubmit:function(e){e.preventDefault(),o({name:d,about:_})},children:Object(n.jsx)(T,{about:_,nameProfile:d,profileMessage:w,editName:function(e){j(e.target.value),C(!e.target.value)},editAbout:function(e){O(e.target.value),C(!e.target.value)},validationProfile:function(e){e.target.validity.valid||S(Object(k.a)({},e.target.name,e.target.validationMessage)),S(Object(k.a)({},e.target.name,""))}})})};var ae=function(e){var t=e.children;return Object(n.jsx)("div",{className:"page",children:t})};var ne=function(){var e=Object(m.g)(),t=r.a.useState({}),a=Object(b.a)(t,2),i=a[0],o=a[1],c=r.a.useState(!1),s=Object(b.a)(c,2),l=s[0],h=s[1],_=r.a.useState(!1),g=Object(b.a)(_,2),f=g[0],k=g[1],C=r.a.useState(!1),N=Object(b.a)(C,2),y=N[0],S=N[1],L=r.a.useState(!1),E=Object(b.a)(L,2),T=E[0],P=E[1],I=r.a.useState(!1),A=Object(b.a)(I,2),F=A[0],M=A[1],W=r.a.useState({name:"",about:"",_id:"",avatar:"",email:""}),H=Object(b.a)(W,2),G=H[0],Q=H[1],V=r.a.useState([]),ne=Object(b.a)(V,2),ie=ne[0],re=ne[1],oe=r.a.useState(!1),ce=Object(b.a)(oe,2),se=ce[0],le=ce[1],ue=r.a.useState(!0),pe=Object(b.a)(ue,2),de=pe[0],je=pe[1],be=r.a.useState(!1),me=Object(b.a)(be,2),he=me[0],_e=me[1],Oe=r.a.useState({}),ve=Object(b.a)(Oe,2),ge=ve[0],fe=ve[1],xe=r.a.useState(!1),ke=Object(b.a)(xe,2),Ce=ke[0],Ne=ke[1],ye=r.a.useState(!0),we=Object(b.a)(ye,2),Se=we[0],Le=we[1],Ee=r.a.useState({isOpenTool:!1,status:!1,message:""}),Te=Object(b.a)(Ee,2),Pe=Te[0],Ie=Te[1],Ae=r.a.useState({}),Fe=Object(b.a)(Ae,2),Ue=Fe[0],Me=Fe[1],De=r.a.useState(!1),Be=Object(b.a)(De,2),Re=Be[0],We=Be[1],ze=r.a.useState({link:"/sign-up",info:""}),qe=Object(b.a)(ze,2),Je=qe[0],He=qe[1];function Ge(e,t){Ie(Object(j.a)(Object(j.a)({},Pe),{},{isOpenTool:!0,status:t,message:e}))}function Ye(){k(!1),S(!1),h(!1),P(!1),Ne(!1),We(!1),Le(!0),Ie(Object(j.a)(Object(j.a)({},Pe),{},{isOpenTool:!1,message:""}))}function Ke(t){t.preventDefault(),e.push("/"),_e(!0),le(!0)}function Qe(e){O.token=localStorage.getItem(e),Promise.all([O.getInfoForUser(),O.getInfoForCards()]).then((function(e){var t=Object(b.a)(e,2),a=t[0],n=t[1];Q(Object(j.a)({},a)),re(Object(d.a)(n)),He({info:"",link:"/sign-up"}),je(!0)})).catch((function(e){console.error("\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u0441 \u043e\u0448\u0438\u0431\u043a\u043e\u0439",e.message),fe(e),je(!1),localStorage.removeItem("jwt"),_e(!1)})).finally((function(){le(!1)}))}function Ve(e){e.preventDefault(),_e(!1)}function Xe(t){"\u0412\u044b\u0439\u0442\u0438"===t.target.text?localStorage.getItem("jwt")?(localStorage.removeItem("jwt"),localStorage.removeItem("email"),Q({name:"",about:"",_id:"",avatar:"",email:""}),Ve(t),e.push("/sign-in")):(localStorage.clear(),Ve(t),e.push("/sign-in")):"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"===t.target.text?(e.push("/sign-up"),He(Object(j.a)(Object(j.a)({},Je),{},{link:"/sign-in"}))):"\u0412\u0445\u043e\u0434"===t.target.text&&(e.push("/sign-in"),He(Object(j.a)(Object(j.a)({},Je),{},{link:"/sign-up"})))}function Ze(e){"Escape"===e.key&&Ye()}function $e(e){return et.apply(this,arguments)}function et(){return(et=Object(p.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t?window.addEventListener("keydown",Ze):window.removeEventListener("keydown",Ze);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return r.a.useEffect((function(){localStorage.getItem("jwt")?(le(!0),_e(!0),Qe("jwt")):localStorage.clear()}),[]),Object(n.jsxs)(r.a.Fragment,{children:[he?Object(n.jsx)(m.a,{to:"/"}):Object(n.jsx)(m.a,{to:"/sign-in"}),Object(n.jsx)(ae,{children:Object(n.jsx)(v.Provider,{value:G,children:Object(n.jsxs)(X,{children:[F&&Object(n.jsx)(w,{selectorPlace:"page",link:Je.link,signOut:Xe}),Object(n.jsx)(D,{selectorPlace:"header",link:Je.link,isNavbarOpen:F,signOut:Xe,toggleNavbar:function(e){e.target.checked?M(!0):M(!1)}}),Object(n.jsx)(Y,{isOpen:Pe,onClose:Ye,toggleEventListenerWindow:$e}),Object(n.jsxs)(m.d,{children:[Object(n.jsxs)(Z,{exact:!0,path:"/",loggedIn:he,children:[se&&Object(n.jsx)(R,{}),Object(n.jsxs)(r.a.Fragment,{children:[Object(n.jsx)(x,{cards:ie,handleCardLike:function(e){var t=e.likes,a=e._id,n=t.some((function(e){return e===G._id}));O.changeLikeCardStatus(a,!n).then((function(e){var t=ie.map((function(t){return t._id===a?e:t}));re(t)})).catch((function(e){return console.error("\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043f\u043e \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0430\u043c \u0441 \u043e\u0448\u0438\u0431\u043a\u043e\u0439",e.message)}))},onAddPlace:function(){h(!0)},handleCardClick:function(e){var t=Object.assign({},e);Me(Object(j.a)({},t)),Ne(!0)},onEditAvatar:function(){k(!0)},onEditProfile:function(){S(!0)},handleCardDelete:function(e){P(!0),o(e)}}),Object(n.jsx)(K,{isOpen:l,isLoadingButton:Re,onClose:Ye,onAddPlace:function(e){var t=e.name,a=e.link;We(!0),O.addCard({name:t,link:a}).then((function(e){return e?re([e].concat(Object(d.a)(ie))):Promise.reject(new Error("\u043e\u0448\u0438\u0431\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445"))})).catch((function(e){return console.error("\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438 \u0441 \u043e\u0448\u0438\u0431\u043a\u043e\u0439",e)})).finally((function(){Ye()}))},toggleEventListenerWindow:$e}),Object(n.jsx)($,{isOpen:f,isLoadingButton:Re,onClose:Ye,onUpdateAvatar:function(e){var t=e.avatar;We(!0),O.updateUserAvatar({avatar:t}).then((function(e){Q(Object(j.a)(Object(j.a)({},G),{},{avatar:e.avatar}))})).catch((function(e){return console.error("\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0441 \u043e\u0448\u0438\u0431\u043a\u043e\u0439",e)})).finally((function(){We(!1),Ye()}))},toggleEventListenerWindow:$e}),Object(n.jsx)(te,{isOpen:y,isLoadingButton:Re,onClose:Ye,onUpdateUser:function(e){var t=e.name,a=e.about;We(!0),O.updateUserInfo({name:t,about:a}).then((function(e){Q(Object(j.a)(Object(j.a)({},G),{},{name:e.name,about:e.about}))})).catch((function(e){return console.error("\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0441 \u043e\u0448\u0438\u0431\u043a\u043e\u0439",e)})).finally((function(){We(!1),Ye()}))},toggleEventListenerWindow:$e}),Object(n.jsx)(ee,{isCard:i,isLoadingButton:Re,isOpen:T,onClose:Ye,onDeleteCard:function(e){var t=e._id,a=t;We(!0),O.deleteCard(t).then((function(){re(ie.filter((function(e){return e._id!==a})))})).catch((function(e){return console.error("\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043f\u043e \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0430\u043c \u0441 \u043e\u0448\u0438\u0431\u043a\u043e\u0439",e.message)})).finally((function(){We(!1),Ye()}))},toggleEventListenerWindow:$e}),Object(n.jsx)(J,{isOpen:Ce,selectedCard:Ue,onClose:Ye,toggleEventListenerWindow:$e})]}),!de&&Object(n.jsx)(q,{error:ge})]}),!se&&Object(n.jsx)(m.b,{path:"/sign-in",exact:!0,children:Object(n.jsx)(U,{isOpen:Se,isLoadingButton:Re,onLogin:function(e,t){We(!0),O.authorizationPost(Object(j.a)({},t)).then((function(t){We(!1),t.token?(localStorage.setItem("jwt",t.token),Ke(e),Qe("jwt"),Le(!1),Ge("\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c \u043d\u0430 \u043f\u0440\u043e\u0435\u043a\u0442 Mesto",!0)):!t.token&&t.message&&Ge(t.message,!1)})).catch((function(e){Ge("",!1),console.error(e)})).finally((function(){We(!1)}))},handleLogin:Ke})}),Object(n.jsx)(m.b,{path:"/sign-up",exact:!0,children:Object(n.jsx)(z,{isOpen:Se,isLoadingButton:Re,signOut:Xe,onRegister:function(t){We(!0),O.register(t).then((function(t){t.data?(We(!1),Ge("",!0),localStorage.setItem("email",t.data.email),e.push("/sign-in"),He(Object(j.a)(Object(j.a)({},Je),{},{link:"/sign-up"}))):t.error?Ge(t.error,!1):t.message?Ge(t.message,!1):console.error("\u0434\u0440\u0443\u0433\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430: res")})).catch((function(e){Ge("",!1),console.error(e)})).finally((function(){We(!1)}))}})})]}),he&&Object(n.jsx)(B,{})]})})})]})};c.a.render(Object(n.jsx)(r.a.StrictMode,{children:Object(n.jsx)(s.a,{children:Object(n.jsx)(ne,{})})}),document.getElementById("root"))}},[[45,1,2]]]);
//# sourceMappingURL=main.7cb815fb.chunk.js.map